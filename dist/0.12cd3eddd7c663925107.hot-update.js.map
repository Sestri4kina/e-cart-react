{"version":3,"sources":["webpack:///./src/app/utils/services/handle-token.ts","webpack:///./src/app/app-component.tsx","webpack:///./src/app/utils/remote-api/products-api.ts"],"names":["handleNotSupported","err","console","log","JSON","stringify","Error","hasAccessToken","localStorage","getItem","accessTokenObject","accessTokenStringified","parse","exports","accessTokenIsExpired","now","Date","expiresAt","accessTokenExpiresAt","persistAccessToken","value","expireTime","accessToken_1","setItem","removeAccessToken","removeItem","accessToken","React","__webpack_require__","auth_api_1","handle_token_1","products_api_1","product_list_1","App","_super","props","_this","call","this","state","products","__extends","prototype","fetchProducts","getAccessToken","authenticate","_a","sent","access_token","expires","getProducts","setState","componentDidMount","render","length","createElement","ProductList","Component","config_1","axios_1","productsPath","moltinBaseAPI","moltinAPI","productAPI","token","headers","default","get","then","res","data","err_1"],"mappings":"oDAAA,SAASA,EAAmBC,GAKxB,MAJAC,QAAQC,IAAI,uEAEFC,KAAKC,UAAUJ,GAAI,cAEvB,IAAIK,MAAML,GAIpB,SAASM,IACL,IACI,QAASC,aAAaC,QAAQ,eAChC,MAAMR,GACJD,EAAmBC,IAI3B,SAASS,IACL,IACI,IAAMC,EAAiCH,aAAaC,QAAQ,gBAAkB,GAC9E,OAAOL,KAAKQ,MAAMD,GAEpB,MAAMV,GACJD,EAAmBC,qDAgB3BY,EAAAC,qBAAA,WACI,IACI,IAAMC,EAAMC,KAAKD,MACjB,OAAIR,KAfZ,WACI,IACI,OAAIA,IACOG,IAAoBO,eAE/B,EACF,MAAMhB,GACJD,EAAmBC,IASRiB,GAAyBH,EAGtC,MAAMd,GACJD,EAAmBC,KAI3BY,EAAAM,mBAAA,SAAmCC,EAAeH,GAC9C,IACI,IAAMI,EAAyB,IAAZJ,EACbK,EAAclB,KAAKC,WAAYe,MAAKA,EAAEH,UAAWI,IACvDb,aAAae,QAAQ,cAAeD,GACtC,MAAMrB,GACJD,EAAmBC,KAI3BY,EAAAW,kBAAA,WACI,IACQjB,KACAC,aAAaiB,WAAW,eAE9B,MAAMxB,GACJD,EAAmBC,KAI3BY,EAAAa,YAAA,WACI,IACI,OAAInB,IACOG,IAAoBU,WAE/B,EACF,MAAMnB,GACJD,EAAmBC,sxDC9E3B,IAAA0B,EAAAC,EAAA,GACAC,EAAAD,EAAA,IACAE,EAAAF,EAAA,IACAG,EAAAH,EAAA,IACAI,EAAAJ,EAAA,IAEAK,EAAA,SAAAC,GACI,SAAAD,EAAYE,GAAZ,IAAAC,EACIF,EAAAG,KAAAC,KAAMH,IAAMG,YACZF,EAAKG,OACDC,eAuCZ,OA3CyBC,EAAAR,EAAAC,GAUfD,EAAAS,UAAAC,cAAN,kHACIzC,QAAQC,IAAI2B,EAAAhB,wBACPgB,EAAAhB,wBACoB,EAAMe,EAAAe,mBAD1B,mBACKC,EAAeC,EAAAC,OACrB7C,QAAQC,IAAI0C,GACZf,EAAAX,mBAAmB0B,EAAaG,aAAcH,EAAaI,sBAE3D/C,QAAQC,IAAI,0DAGC,SAAM4B,EAAAmB,6BAAjBV,EAAWM,EAAAC,OACjBT,KAAKa,UACDX,SAAQA,cAIhBP,EAAAS,UAAAU,kBAAA,WACId,KAAKK,iBAGTV,EAAAS,UAAAW,OAAA,WACY,IAAAb,EAAAF,KAAAC,MAAAC,SAGR,OAFAtC,QAAQC,IAAIqC,GACZtC,QAAQC,MAAMqC,EAASc,UACdd,EAASc,QACd3B,EAAA4B,cAAA,WACI5B,EAAA4B,cAAA,sBAGA5B,EAAA4B,cAACvB,EAAAwB,aAAYhB,SAAUA,MAIvCP,EA3CA,CAAyBN,EAAM8B,WAAlB5C,EAAAoB,s7CCNb,IAAAyB,EAAA9B,EAAA,GACA+B,EAAA/B,EAAA,IACAE,EAAAF,EAAA,IAEAf,EAAAqC,YAAA,+GAQyB,6BANXU,EAAeF,EAAAG,cAAgBH,EAAAI,UAAUC,WACzCC,EAAQlC,EAAAJ,eAERuC,MACiB,cAAI,UAAUD,GAEpB,EAAML,EAAAO,QAAMC,IACzBP,GACEK,QAAOA,IACXG,KAAK,SAAAC,GAAO,OAAAA,EAAIC,KAAKA,eAEvB,SALiBxB,EAAAC,iCAOjB7C,QAAQC,IAAIoE","file":"0.12cd3eddd7c663925107.hot-update.js","sourcesContent":["function handleNotSupported(err: any) {\n    console.log(`\n            Probably local storage is not supported.\n            ${JSON.stringify(err)}\n        `);\n    throw new Error(err);\n}\n\n//check whether there is access token in localStorage\nfunction hasAccessToken() {\n    try {\n        return !!localStorage.getItem('accessToken');\n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n\nfunction accessTokenObject() {\n    try {\n        const accessTokenStringified: string = localStorage.getItem('accessToken') || '';\n        return JSON.parse(accessTokenStringified);\n        \n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n\nfunction accessTokenExpiresAt() {\n    try {\n        if (hasAccessToken()) {\n            return accessTokenObject().expiresAt;\n        } \n        return undefined;\n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n\n//check whether token is expired\nexport function accessTokenIsExpired() {\n    try {\n        const now = Date.now();\n        if (hasAccessToken()) {\n            return accessTokenExpiresAt() < now;\n        }\n        return true;\n    } catch(err) {\n        handleNotSupported(err);\n    }\n} \n\nexport function persistAccessToken(value: string, expiresAt: number) {\n    try {\n        const expireTime = expiresAt * 1000;\n        const accessToken = JSON.stringify({ value, expiresAt: expireTime })\n        localStorage.setItem('accessToken', accessToken);\n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n\nexport function removeAccessToken() {\n    try {\n        if (hasAccessToken()) {\n            localStorage.removeItem('accessToken');\n        }\n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n\nexport function accessToken() {\n    try {\n        if (hasAccessToken()) {\n            return accessTokenObject().value;\n        } \n        return undefined;\n    } catch(err) {\n        handleNotSupported(err);\n    }\n}\n","import * as React from \"react\";\nimport { getAccessToken } from './utils/remote-api/auth-api';\nimport { persistAccessToken, accessTokenIsExpired, removeAccessToken } from './utils/services/handle-token';\nimport { getProducts } from './utils/remote-api/products-api';\nimport { ProductList } from \"./components/product-list\";\n\nexport class App extends React.Component<any, any> {\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            products: []\n        };\n\n        //this.fetchProducts = this.fetchProducts.bind(this);\n    }\n\n    async fetchProducts() {\n        console.log(accessTokenIsExpired())\n        if  (accessTokenIsExpired()) {\n            const authenticate = await getAccessToken();\n            console.log(authenticate);\n            persistAccessToken(authenticate.access_token, authenticate.expires);\n        } else {\n            console.log(\"there is already token in the storage\");\n        }\n\n        const products = await getProducts();\n        this.setState({\n            products\n        });\n    }\n\n    componentDidMount() {\n        this.fetchProducts();\n    }\n\n    render() {\n        const { products } = this.state;\n        console.log(products);\n        console.log(!!products.length);\n        return !!products.length && (\n            <div>\n                <h1>\n                    products\n                </h1>\n                <ProductList products={products} />\n            </div>\n        );\n    }\n}\n","import { moltinBaseAPI, moltinAPI } from '../config';\nimport axios from 'axios';\nimport { accessToken } from '../services/handle-token';\n\nexport async function getProducts() {\n    try {\n        const productsPath = moltinBaseAPI + moltinAPI.productAPI;\n        const token = accessToken();\n\n        const headers: any = {};\n        headers['Authorization'] = `Bearer ${token}`;\n\n        const products = await axios.get(\n            productsPath,\n            { headers }\n        ).then(res => res.data.data);\n\n        return products;\n    } catch(err) {\n        console.log(err);\n    }\n}"],"sourceRoot":""}